/* =========================================
   NULSIGHT - MOBILE FIRST GAME UI
   Server authoritative safe (UI only)
========================================= */

body {
    overflow-x: hidden;
}

:root {
    --zone-cell: clamp(62px, 16.8vw, 112px);
    --overlay-panel-w: min(980px, 95vw);
    --overlay-card-w: 118px;
    --overlay-card-h: 160px;
}

.game-wrap {
    position: relative;
    padding-top: 6px;
}

.hud,
.game-toolbar,
.board,
.hand-wrap {
    width: 100%;
    margin-left: auto;
    margin-right: auto;
}

/* =============================
   HUD (전황 상단)
============================= */

.hud {
    margin-top: 8px;
    padding: var(--sp-6);
    border-radius: var(--r-sm);
    border: 2px solid var(--c-ink-border);
    background: linear-gradient(180deg, var(--c-surface-1), var(--c-surface-1));
    box-shadow: 5px 5px 0 var(--p-bg-980);
    display: grid;
    gap: var(--sp-4);
}

.hud-main {
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.hud-turn {
    font-weight: 900;
    font-size: 15px;
    letter-spacing: 0.3px;
}

.hud-turn.is-me {
    color: var(--p-accent-field);
}

.hud-turn.is-opp {
    color: var(--p-accent-blue-soft);
}

.hud-phase {
    padding: 4px 12px;
    border-radius: 999px;
    font-size: var(--fs-min-readable);
    font-weight: 700;
    background: var(--c-card-slot-top);
}

.hud-sub {
    display: flex;
    justify-content: space-between;
    flex-wrap: wrap;
    gap: var(--sp-3);
}

.hud-focus {
    font-size: var(--fs-min-readable);
    opacity: 0.9;
}

.hud-meta {
    display: flex;
    gap: var(--sp-3);
    flex-wrap: wrap;
}

.hud-notice {
    font-size: var(--fs-min-readable);
    opacity: 0.9;
}

/* =============================
   TOOLBAR
============================= */

.game-toolbar {
    margin-top: 10px;
    display: flex;
    gap: var(--sp-4);
    flex-wrap: wrap;
}

.game-toolbar.inboard {
    margin-top: 0;
    width: 100%;
}

.game-toolbar button {
    flex: 1;
    min-height: 44px;
}

/* =============================
   BOARD STRUCTURE
============================= */

.board {
    margin-top: 14px;
    display: grid;
    gap: var(--sp-8);
    justify-items: center;
    transition: 140ms ease;
}

.zone-block {
    width: 100%;
    border: 2px solid var(--c-ink-border);
    border-radius: var(--r-sm);
    padding: var(--sp-6);
    background: linear-gradient(180deg, var(--c-surface-1), var(--c-surface-1));
    box-shadow: 6px 6px 0 var(--p-bg-980);
    overflow: hidden;
}

.zone-block.is-active-turn {
    border-color: var(--p-accent-field);
    box-shadow: 0 0 0 2px color-mix(in srgb, var(--p-accent-field) 42%, transparent) inset, 6px 6px 0 var(--p-bg-980);
    background: linear-gradient(180deg,
            color-mix(in srgb, var(--c-surface-1) 86%, var(--p-accent-field) 14%),
            var(--c-surface-1));
}

.zone-block.is-waiting-turn {
    border-color: var(--p-accent-blue-soft);
}

.zone-title {
    font-weight: 900;
    margin-bottom: 8px;
    font-size: var(--fs-min-readable);
}

.field-matrix {
    width: 100%;
    display: flex;
    justify-content: space-between;
    align-items: stretch;
    gap: var(--sp-5);
}

.field-main {
    flex: 1;
    min-width: 0;
    display: grid;
    gap: var(--sp-5);
    justify-items: center;
}

.field-side {
    flex: 0 0 auto;
    width: var(--zone-cell);
    display: grid;
    grid-template-rows: 1fr 1fr;
    gap: var(--sp-4);
}

.zone-row {
    width: 100%;
    display: flex;
    justify-content: center;
}

.slots {
    display: grid;
    width: max-content;
    gap: var(--sp-4);
    justify-content: center;
    margin: 0 auto;
}

.monster {
    grid-template-columns: repeat(3, var(--zone-cell));
}

.spell {
    grid-template-columns: repeat(4, var(--zone-cell));
}

.slot {
    aspect-ratio: 3 / 4;
    border-radius: var(--r-sm);
    border: 2px solid var(--c-ink-border);
    background: linear-gradient(180deg, var(--c-card-slot-top), var(--c-card-slot-bottom));
    padding: 6px;
    font-size: var(--fs-min-readable);
    transition: 120ms ease;
    display: flex;
    align-items: stretch;
    justify-content: stretch;
    text-align: left;
    overflow: hidden;
}

.slot.clickable {
    cursor: pointer;
}

.slot.clickable:active {
    transform: scale(0.95);
}

.slot.targetable {
    border-color: var(--p-accent-blue-soft);
    box-shadow: 0 0 0 2px color-mix(in srgb, var(--p-accent-blue-soft) 45%, transparent) inset;
}

.slot.target-picked {
    border-color: var(--p-accent-field);
    box-shadow: 0 0 0 2px var(--c-accent-blue-glow-strong) inset;
}

.slot.attacker-picked {
    border-color: var(--p-accent-blue-soft);
    box-shadow: 0 0 0 2px var(--c-accent-blue-glow-strong) inset;
}

.slot.exhausted {
    opacity: 0.56;
    filter: saturate(0.7);
}

.zone-footer {
    margin-top: 10px;
    display: flex;
    gap: var(--sp-4);
    align-items: stretch;
}

.attack-agent {
    flex: 0 0 auto;
    min-width: 132px;
    min-height: 44px;
    padding: 0 14px;
    border-radius: var(--r-sm);
}

/* =============================
   SIDE INFO
============================= */

.side {
    flex: 1;
    display: grid;
    grid-template-columns: repeat(3, minmax(0, 1fr));
    gap: var(--sp-4);
}

.stat-box {
    border: 2px solid var(--c-ink-border);
    border-radius: var(--r-sm);
    padding: var(--sp-4);
    background: var(--c-surface-1);
    min-height: 54px;
    display: grid;
    align-content: center;
    gap: var(--sp-1);
}

.stat-hp {
    border-color: var(--c-accent-hp-border);
    box-shadow: inset 0 0 0 1px var(--c-accent-blue-glow-strong);
}

.stat-mana {
    border-color: var(--p-accent-blue-soft);
    box-shadow: inset 0 0 0 1px var(--c-accent-blue-glow-strong);
}

.stat-label {
    font-size: var(--fs-min-readable);
    color: var(--c-text-soft);
    line-height: 1;
}

.stat-value {
    font-weight: 900;
    font-size: var(--fs-min-readable);
    line-height: 1.2;
}

/* =============================
   FIELD UTILITY ZONES (무덤/덱)
============================= */

.utility-zone {
    box-sizing: border-box;
    border: 2px solid var(--c-ink-border);
    border-radius: var(--r-sm);
    padding: 6px;
    background: linear-gradient(180deg, var(--c-card-slot-top), var(--c-card-slot-bottom));
    font-size: var(--fs-min-readable);
    text-align: center;
    width: 100%;
    aspect-ratio: 3 / 4;
    display: grid;
    place-items: center;
    font-weight: 800;
}

/* =============================
   HAND (모바일 우선)
============================= */

.hand-wrap {
    margin-top: 14px;
}

.hand {
    --hand-overlap: 0px;
    position: relative;
    height: auto;
    min-height: 0;
    display: flex;
    flex-wrap: nowrap;
    align-items: stretch;
    justify-content: center;
    overflow: hidden;
    gap: 0;
    padding-inline: 2px;
    padding-bottom: 10px;
}

.hand-card {
    position: relative;
    left: auto;
    bottom: auto;
    transform: none;
    transform-origin: center;
    z-index: calc(var(--hand-i, 0) + 1);
    flex: 0 0 auto;
    width: 110px;
    height: 150px;
    border-radius: var(--r-sm);
    border: 2px solid var(--c-ink-border);
    background: linear-gradient(180deg, var(--c-card-slot-top), var(--c-card-slot-bottom));
    padding: var(--sp-4);
    font-size: var(--fs-min-readable);
    transition: 120ms ease;
    white-space: normal;
    overflow: hidden;
    margin-left: calc(var(--hand-overlap) * -1);
}

.hand-card:first-child {
    margin-left: 0;
}

.hand-card:active {
    transform: translateY(-2px) scale(0.98);
}

.hand-card.pressing,
.slot.pressing,
.grave-card.pressing {
    box-shadow: 0 0 0 2px var(--c-accent-blue-glow-strong) inset, 0 0 12px var(--c-accent-blue-glow-strong);
    transform: translateY(-4px) scale(0.99);
}

.hand-card.sel {
    border-color: var(--p-accent-blue-soft);
    box-shadow: 0 0 14px var(--c-accent-blue-glow-strong);
    transform: translateY(-8px);
    z-index: 100;
}

.slot-empty {
    width: 100%;
    height: 100%;
    border-radius: var(--r-sm);
    border: 1px dashed var(--c-line-soft);
    background: var(--c-deep-panel-92);
}

.card-mini {
    width: 100%;
    height: 100%;
    display: flex;
    flex-direction: column;
    gap: var(--sp-2);
    overflow: hidden;
    border-radius: calc(var(--r-sm) - 2px);
}

.card-mini.card-mini--unit {
    background: linear-gradient(180deg, var(--c-card-unit-top), var(--c-card-unit-bottom));
}

.card-mini.card-mini--spell {
    background: linear-gradient(180deg, var(--c-card-spell-top), var(--c-card-spell-bottom));
}

.card-mini__name {
    font-weight: 800;
    font-size: var(--fs-min-readable);
    line-height: 1.15;
}

.card-mini__effect {
    font-size: var(--fs-body);
    line-height: 1.4;
    color: var(--c-text);
    display: -webkit-box;
    -webkit-line-clamp: 4;
    -webkit-box-orient: vertical;
    overflow: hidden;
}

.card-mini__stat {
    margin-top: auto;
    font-size: var(--fs-min-readable);
    font-weight: 900;
    color: var(--c-text-strong);
}

.card-mini.hand .card-mini__effect {
    -webkit-line-clamp: 5;
}


.phase-fx {
    position: fixed;
    left: 50%;
    top: 84px;
    transform: translateX(-50%) translateY(-6px);
    z-index: 10000;
    pointer-events: none;
    padding: 8px 14px;
    border-radius: 999px;
    border: 1px solid var(--c-line-soft);
    background: var(--c-deep-panel-92);
    color: var(--c-text-strong);
    font-size: var(--fs-min-readable);
    font-weight: 800;
    letter-spacing: 0.02em;
    opacity: 0;
    transition: opacity .22s ease, transform .22s ease;
}

.phase-fx.show {
    opacity: 1;
    transform: translateX(-50%) translateY(0);
}

.phase-fx.hidden {
    display: none;
}

/* =============================
   GRAVE DRAWER
============================= */

.grave-drawer {
    position: fixed;
    top: 0;
    right: 0;
    width: min(420px, 92vw);
    height: 100dvh;
    z-index: 10020;
    background: linear-gradient(180deg, var(--c-surface-1), var(--c-surface-1));
    border-left: 1px solid var(--c-line-1);
    box-shadow: var(--c-shadow-1);
    padding: var(--sp-6);
    display: flex;
    flex-direction: column;
    gap: var(--sp-5);
    overscroll-behavior: contain;
}

.grave-drawer.hidden {
    display: none;
}

.grave-drawer__head {
    display: flex;
    justify-content: space-between;
    align-items: center;
    gap: var(--sp-4);
}

.grave-drawer__list {
    flex: 1;
    overflow-y: auto;
    display: grid;
    grid-template-columns: repeat(2, minmax(0, 1fr));
    gap: var(--sp-4);
    align-content: start;
}

.grave-card {
    width: 100%;
    height: 150px;
}

/* =============================
   CARD INSPECT OVERLAY
============================= */

.card-overlay {
    position: fixed;
    inset: 0;
    z-index: 10040;
    display: grid;
    place-items: center;
}

#effectPickOverlay {
    z-index: 10060;
}

#cardInspectOverlay {
    z-index: 10080;
}

.card-overlay.hidden {
    display: none;
}

.card-overlay__backdrop {
    position: absolute;
    inset: 0;
    background: var(--c-overlay-backdrop);
    backdrop-filter: var(--c-overlay-blur);
}

.card-overlay__panel {
    position: relative;
    width: var(--overlay-panel-w);
    max-height: 92dvh;
    overflow: auto;
    border: 1px solid var(--c-line-1);
    border-radius: var(--r-lg);
    background: linear-gradient(180deg, var(--c-surface-1), var(--c-surface-1));
    box-shadow: var(--c-shadow-1);
    padding: var(--sp-6);
}

.card-overlay__head {
    display: flex;
    align-items: center;
    justify-content: space-between;
}

.card-overlay__content {
    margin-top: 10px;
    display: grid;
    grid-template-columns: minmax(180px, 240px) minmax(0, 1fr);
    gap: var(--sp-6);
}

.card-overlay__preview .hand-card {
    width: 100%;
    height: auto;
    min-height: 290px;
    margin-left: 0;
}

.card-overlay__body {
    display: grid;
    gap: var(--sp-6);
}

.card-overlay__title {
    font-size: 18px;
    font-weight: 900;
}

.card-overlay__line {
    font-size: var(--fs-min-readable);
    opacity: 0.92;
}

.card-overlay__effect {
    margin-top: 8px;
    font-size: var(--fs-body);
    line-height: 1.4;
    color: var(--c-text);
    white-space: pre-wrap;
}

.card-overlay__sub {
    margin: 0 0 8px;
    font-size: var(--fs-min-readable);
}

.card-overlay__keywords {
    display: grid;
    gap: var(--sp-4);
}

.card-overlay__kw {
    border: 1px solid var(--c-line-1);
    border-radius: var(--r-sm);
    padding: 8px 10px;
    display: grid;
    gap: var(--sp-2);
    background: var(--c-surface-1);
}

.card-overlay__kw strong {
    font-size: var(--fs-min-readable);
}

.card-overlay__kw span {
    font-size: var(--fs-min-readable);
    color: var(--c-text-strong);
}


.effect-pick-overlay__panel {
    width: var(--overlay-panel-w);
}

.effect-pick-overlay__guide {
    margin: 8px 0 10px;
}

.effect-pick-overlay__list {
    display: flex;
    gap: var(--sp-4);
    overflow-x: auto;
    overflow-y: hidden;
    padding: 6px 2px 10px;
    scroll-snap-type: x proximity;
}

.effect-pick-overlay__item {
    flex: 0 0 auto;
    width: var(--overlay-card-w);
    height: var(--overlay-card-h);
    margin-left: 0;
    cursor: pointer;
    scroll-snap-align: start;
}

/* =============================
   GAME END OVERLAY
============================= */

.game-end-overlay {
    position: fixed;
    inset: 0;
    background: var(--c-overlay-backdrop);
    backdrop-filter: var(--c-overlay-blur);
    display: grid;
    place-items: center;
    z-index: 10100;
}

.game-end-overlay.hidden {
    display: none;
}

.game-end-box {
    background: var(--c-surface-1);
    padding: 24px;
    border-radius: var(--r-lg);
    border: 1px solid var(--c-line-1);
    box-shadow: var(--c-shadow-1);
    text-align: center;
    min-width: 240px;
}

.game-end-box button {
    margin-top: 12px;
    min-height: 44px;
    padding: 0 14px;
    border-radius: var(--r-sm);
}

@media (min-width: 1024px) {
    .hud,
.game-toolbar,
.board,
.hand-wrap {
        width: min(90%, 1280px);
    }
}

@media (min-width: 1320px) {
    :root {
        --zone-cell: clamp(78px, 5.8vw, 108px);
    }
}

@media (max-width: 420px) {
    :root {
        --zone-cell: clamp(52px, 14.2vw, 64px);
    }

    .zone-block {
        padding: var(--sp-5);
    }

    .field-matrix {
        gap: var(--sp-3);
    }

    .field-side {
        width: var(--zone-cell);
        gap: var(--sp-3);
    }

    .utility-zone {
        font-size: var(--fs-min-readable);
        padding: 6px;
    }
}

@media (min-width: 421px) and (max-width: 560px) {
    :root {
        --zone-cell: clamp(48px, 13.8vw, 62px);
    }

    .zone-block {
        padding: var(--sp-5);
    }

    .field-matrix {
        gap: var(--sp-3);
        align-items: flex-start;
    }

    .field-main {
        gap: var(--sp-4);
    }

    .slots {
        gap: var(--sp-3);
    }

    .field-side {
        width: var(--zone-cell);
        gap: var(--sp-3);
    }

    .zone-footer {
        flex-wrap: wrap;
    }

    .attack-agent {
        min-width: 100%;
    }
}

@media (max-width: 560px) {
    :root {
        --overlay-panel-w: 95vw;
        --overlay-card-w: 118px;
        --overlay-card-h: 160px;
    }

    .hand {
        gap: 0;
        padding-bottom: 12px;
    }

    .hand-card {
        width: 118px;
        height: 160px;
    }

    .card-overlay__panel {
        padding: var(--sp-5);
    }

    .card-overlay__content {
        grid-template-columns: 1fr;
    }

    .card-overlay__preview .hand-card {
        max-width: 220px;
        min-height: 0;
        margin: 0 auto;
    }
}
